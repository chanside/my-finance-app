<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>理財小幫手 — 單檔版</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="title">
        <div class="logo">$</div>
        <h1>理財小幫手</h1>
      </div>
      <div class="actions">
  <div class="qr-section">
    <button class="btn" onclick="startQRScanner()">啟用相機</button>
    <button id="switch-camera-btn" class="btn" onclick="switchCamera()" style="display: none;">切換鏡頭</button>
  </div>
  <button id="exportBtn">匯出資料</button>
  <button id="importBtn">匯入資料</button>
  <input type="file" id="fileInput" accept="application/json" hidden>
  <button id="resetBtn">全部重置</button>
  <div id="qrScanner" style="display:none; text-align:center; margin:20px 0;">
  <video id="video" width="320" height="240" autoplay playsinline></video>
  <canvas id="qr-canvas" hidden></canvas>
</div>
<div id="qrResult"></div>
</div>

    </header>

    <!-- Summary Cards -->
    <div class="grid cards">
      <div class="card">
        <h3>可支配餘額</h3>
        <div class="money" id="balance">$0</div>
        <div class="muted" id="balanceNote">包含本月收入與支出</div>
      </div>
      <div class="card">
        <h3>本月收入</h3>
        <div class="money good" id="income">$0</div>
        <div class="muted" id="incomeCount">0 筆</div>
      </div>
      <div class="card">
        <h3>本月支出</h3>
        <div class="money bad" id="expense">$0</div>
        <div class="muted" id="expenseCount">0 筆</div>
      </div>
      <div class="card">
        <h3>個人儲蓄率</h3>
        <div class="money warn" id="savingRate">0%</div>
        <div class="muted">儲蓄金額 / 可支配收入× 100%。 </div>
      </div>
    </div>

    <div class="panel">
      <!-- Left: Transactions + Table -->
      <div class="card">
        <div class="section-title">
          <h2>新增交易</h2>
        </div>
        <div class="form-row">
          <label>日期
            <input type="date" id="txDate">
          </label>
          <label>類型
            <select id="txType">
              <option value="income">收入</option>
              <option value="expense" selected>支出</option>
            </select>
          </label>
          <label>金額
            <input type="number" id="txAmount" placeholder="例如 1200" min="0" step="0.01">
          </label>
          <label>分類
            <input list="catList" id="txCategory" placeholder="例如 餐飲"/>
            <datalist id="catList">
              <option>餐飲</option><option>交通</option><option>娛樂</option><option>房租</option><option>購物</option><option>薪資</option><option>投資</option><option>醫療</option>
            </datalist>
          </label>
          <label>備註
            <input id="txNote" placeholder="可留空" />
          </label>
          <label> 　
            <button class="primary" id="addBtn" style="width:100%">加入</button>
          </label>
        </div>

        <div class="section-title" style="margin-top:18px">
          <h2>交易紀錄</h2>
          <div class="form-actions">
            <input id="q" placeholder="關鍵字搜尋 (分類/備註)" />
            <select id="fType">
              <option value="all">全部</option>
              <option value="income">收入</option>
              <option value="expense">支出</option>
            </select>
            <input type="month" id="fMonth">
          </div>
        </div>
        <table class="table" id="txTable">
          <thead><tr>
            <th>日期</th><th>類型</th><th>分類</th><th>備註</th><th>金額</th><th></th>
          </tr></thead>
          <tbody id="txTbody"></tbody>
        </table>
      </div>

      <!-- Right: Budget & Chart & Goals -->
      <div class="card">
        <div class="section-title">
          <h2>預算追蹤</h2>
          <div class="form-actions">
            <input id="budgetCat" placeholder="分類，如 餐飲">
            <input id="budgetAmt" type="number" min="0" step="0.01" placeholder="每月預算">
            <button id="setBudget">設定/更新</button>
          </div>
        </div>
        <div id="budgetList"></div>

        <div class="section-title" style="margin-top:18px">
          <h2>月度走勢</h2>
          <div class="muted">近 12 個月收入/支出</div>
        </div>
        <canvas id="chart" width="800" height="260"></canvas>

        <div class="section-title" style="margin-top:18px">
          <h2>儲蓄目標</h2>
          <div class="form-actions">
            <input id="goalName" placeholder="例如 緊急預備金">
            <input id="goalTarget" type="number" min="0" step="0.01" placeholder="目標金額">
            <button id="addGoal">新增目標</button>
          </div>
        </div>
        <div id="goalList"></div>
        <div class="footnote">小技巧：可用 <span class="kbd">Export</span> 匯出備份，或以 <span class="kbd">Reset</span> 清空。</div>
      </div>
    </div>
  </div>
  <div id="qr-reader" style="width: 300px; margin: 10px auto; display: none;"></div>
  <script src="QRCODE.js"></script>
  <script src="script.js"></script>
  <script src="https://unpkg.com/html5-qrcode"></script>
</body>
</html>
